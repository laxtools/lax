# Argos 

피리 소리에 잠들지만 않으면 100개의 눈으로 서비스를 지키는 거인이다. 

![img](file:///D:/laxtools/lax/test/actor/argos/argos.jpg?lastModify=1516939649)



액터들을 path 형태의 키를 갖고 관리한다. 각 액터별 (서비스도 액터)로 카운터를 

관리한다. 카운터들은 메세지를 통해 전달한다. 카운터 값은 각 액터들이 보내온다. 

액터들에게 요청하여 시작하고 불필요할 경우 중단하고 간격을 조절한다. 

## Counter 

counter는 MIB와 같이 경로 형식을 사용한다. 문자열로 처리한다.  

server.service.actor.*.counter를 경로로 한다. *는 여러 액터가 올 수 있음을 의미한다. 

path로는 정확한 의미를 알 수 없어 counter 중 desc를 추가하여 얻어온다. 

예를 들어,  3.1.5.desc = "host.instance_service.room5"  형태이다. 



## 조회 

3.*는 서버 3번의 모든 counter를 의미한다. 

counter 경로 전체로 조회할 경우는 간단하다. 상위 경로로 조회할 경우 전체 counter를 

스캔해야 한다.  정렬된 path index를 사용하고 바이너리 검색을 수정해서 사용하면 

빠르게 시작 지점을 찾아서 scan 할 수 있다. 

counter의 값은 json 문자열로 저장한다. 이름과 값을 별도의 메세지 추가 없이 처리 가능하게 한다. 

## 명령 

명령은 문자열로 전달하고 결과도 json 문자열로 받는다. 개별적인 구현을 피하기 위해 사용한다. 

메세지로 할 수도 있지만 일반화된 처리가 더 간편하다. 









